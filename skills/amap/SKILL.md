---
name: amap
description: 高德地图导航与位置服务工具。使用此 Skill 进行地点搜索、地址解析、路线规划、实时交通查询、周边搜索、天气查询等地图相关操作。当用户需要查询地点信息、规划出行路线、查找附近设施、获取交通状况、查询天气、进行地理编码转换时触发此 Skill。关键词包括：导航、路线、怎么走、多远、多长时间、附近、周边、地址、位置、交通、堵车、天气等。
---

# 高德地图导航服务 Skill

提供基于高德地图 API 的全方位位置服务和导航能力。

## 核心能力

| 能力 | 描述 | 典型场景 |
|------|------|----------|
| 🔍 地点搜索 | 关键词搜索、周边搜索、多边形搜索 | "找一下北京的星巴克" |
| 📍 地理编码 | 地址转坐标、坐标转地址 | "天安门的经纬度是多少" |
| 🚗 路线规划 | 驾车/步行/骑行/公交路线 | "从公司到机场怎么走" |
| 🚦 实时交通 | 路况查询、拥堵分析 | "现在三环堵不堵" |
| 🌤️ 天气服务 | 实时天气、天气预报 | "明天北京天气怎么样" |
| 📏 距离计算 | 直线距离、驾车距离 | "这两个地方有多远" |

## 工具使用指南

### 1. 地点搜索 (maps_text_search)

**用途**: 根据关键词搜索地点

**参数**:
- `keywords` (必需): 搜索关键词，如 "肯德基"、"加油站"
- `city` (推荐): 城市名称或 adcode，限定搜索范围
- `types` (可选): POI 类型代码，如 "050000" (餐饮)
- `page_size` (可选): 返回结果数量，默认 10
- `page_num` (可选): 页码，默认 1

**示例调用**:
```json
{
  "keywords": "星巴克",
  "city": "北京",
  "page_size": 5
}
```

**结果解读**: 返回地点名称、地址、经纬度、电话、营业时间等信息。

---

### 2. 周边搜索 (maps_around_search)

**用途**: 以某点为中心搜索周边设施

**参数**:
- `keywords` (必需): 搜索关键词
- `location` (必需): 中心点坐标，格式 "经度,纬度"
- `radius` (可选): 搜索半径，单位米，默认 3000，最大 50000
- `types` (可选): POI 类型代码
- `page_size` (可选): 返回数量

**示例调用**:
```json
{
  "keywords": "停车场",
  "location": "116.397428,39.90923",
  "radius": 1000
}
```

**使用技巧**: 
- 如果用户说"附近"但没给位置，先询问或使用 IP 定位获取大致位置
- 半径根据设施类型调整：便利店用 500-1000m，医院用 3000-5000m

---

### 3. 地理编码 (maps_geo)

**用途**: 将文字地址转换为经纬度坐标

**参数**:
- `address` (必需): 结构化地址，如 "北京市朝阳区阜通东大街6号"
- `city` (可选): 城市名称，提高解析准确性

**示例调用**:
```json
{
  "address": "北京市海淀区中关村大街1号",
  "city": "北京"
}
```

**返回信息**: 经纬度、省市区、街道、门牌号、adcode 等。

---

### 4. 逆地理编码 (maps_regeo)

**用途**: 将经纬度坐标转换为详细地址

**参数**:
- `location` (必需): 坐标，格式 "经度,纬度"

**示例调用**:
```json
{
  "location": "116.397428,39.90923"
}
```

**返回信息**: 格式化地址、省市区县、街道、门牌号、周边 POI 等。

---

### 5. 驾车路线规划 (maps_direction_driving)

**用途**: 规划驾车路线，支持多种策略

**参数**:
- `origin` (必需): 起点坐标，格式 "经度,纬度"
- `destination` (必需): 终点坐标，格式 "经度,纬度"
- `strategy` (可选): 路线策略
  - `0`: 速度优先（默认）
  - `1`: 费用优先（不走收费路）
  - `2`: 距离优先
  - `4`: 躲避拥堵
  - `5`: 多策略（同时返回多条路线）

**示例调用**:
```json
{
  "origin": "116.481028,39.989643",
  "destination": "116.434446,39.90816",
  "strategy": 4
}
```

**结果包含**: 总距离、预计时间、收费金额、路线描述、导航指引。

---

### 6. 步行路线规划 (maps_direction_walking)

**用途**: 规划步行路线

**参数**:
- `origin` (必需): 起点坐标
- `destination` (必需): 终点坐标

**结果包含**: 步行距离、预计时间、详细步行指引。

---

### 7. 骑行路线规划 (maps_direction_bicycling)

**用途**: 规划骑行路线（自行车/电动车）

**参数**:
- `origin` (必需): 起点坐标
- `destination` (必需): 终点坐标

---

### 8. 公交路线规划 (maps_direction_transit_integrated)

**用途**: 规划公共交通路线（地铁+公交）

**参数**:
- `origin` (必需): 起点坐标
- `destination` (必需): 终点坐标
- `city` (必需): 城市名称或 adcode
- `strategy` (可选): 换乘策略
  - `0`: 最快捷
  - `1`: 最经济
  - `2`: 最少换乘
  - `3`: 最少步行
  - `5`: 不坐地铁

**示例调用**:
```json
{
  "origin": "116.481028,39.989643",
  "destination": "116.434446,39.90816",
  "city": "北京",
  "strategy": 2
}
```

**结果包含**: 总时间、总费用、换乘次数、详细换乘方案。

---

### 9. 距离测量 (maps_distance)

**用途**: 计算多个点之间的距离

**参数**:
- `origins` (必需): 起点坐标，多个用 `|` 分隔
- `destination` (必需): 终点坐标
- `type` (可选): 
  - `1`: 直线距离（默认）
  - `2`: 驾车距离

**示例调用**:
```json
{
  "origins": "116.481028,39.989643|116.291028,39.889643",
  "destination": "116.434446,39.90816",
  "type": 2
}
```

---

### 10. 天气查询 (maps_weather)

**用途**: 查询实时天气和天气预报

**参数**:
- `city` (必需): 城市名称或 adcode
- `extensions` (可选):
  - `base`: 实时天气（默认）
  - `all`: 天气预报（未来几天）

**示例调用**:
```json
{
  "city": "北京",
  "extensions": "all"
}
```

**返回信息**: 
- 实时：温度、湿度、风向、风力、天气状况
- 预报：日期、白天/夜间天气、温度范围、风力

---

### 11. IP 定位 (maps_ip_location)

**用途**: 根据 IP 地址获取大致位置

**参数**:
- `ip` (可选): IP 地址，不传则使用当前 IP

**返回信息**: 省份、城市、adcode。

**注意**: IP 定位精度较低，通常只能到城市级别。

---

## 常见场景处理流程

### 场景 1: "从A到B怎么走最快"

```
1. 使用 maps_geo 将 A 地址转换为坐标
2. 使用 maps_geo 将 B 地址转换为坐标
3. 使用 maps_direction_driving 规划路线（strategy=4 躲避拥堵）
4. 整理返回：总距离、预计时间、主要路线描述
```

### 场景 2: "我附近有什么好吃的"

```
1. 询问用户位置，或使用 maps_ip_location 获取大致城市
2. 如有精确位置，使用 maps_around_search 搜索周边餐厅
3. 如只有城市，使用 maps_text_search 在该城市搜索美食
4. 返回推荐列表（名称、距离、评分、地址）
```

### 场景 3: "北京到上海坐高铁还是飞机"

```
1. 使用 maps_geo 获取北京、上海中心坐标
2. 使用 maps_direction_driving 计算驾车距离和时间（作为参考）
3. 说明高德 API 不支持飞机/高铁查询，建议使用其他平台
4. 可提供两地直线距离作为参考
```

### 场景 4: "这个地址在哪"

```
1. 使用 maps_geo 解析地址
2. 返回经纬度、所属区域
3. 可选：使用 maps_around_search 查找周边标志性地点辅助定位
```

## 坐标格式说明

高德地图使用 **GCJ-02 坐标系**（火星坐标系）：
- 格式：`经度,纬度`（注意顺序）
- 示例：`116.397428,39.90923`（天安门）
- 经度范围：73° ~ 135°
- 纬度范围：3° ~ 54°

**注意**: 
- GPS 原始坐标（WGS-84）需要转换后才能使用
- 百度地图坐标（BD-09）不能直接使用

## POI 类型代码参考

| 大类 | 代码 | 说明 |
|------|------|------|
| 餐饮 | 050000 | 餐厅、小吃、咖啡厅等 |
| 购物 | 060000 | 商场、超市、便利店等 |
| 住宿 | 100000 | 酒店、宾馆、民宿等 |
| 交通 | 150000 | 机场、火车站、公交站等 |
| 医疗 | 090000 | 医院、诊所、药店等 |
| 教育 | 141200 | 学校、培训机构等 |
| 金融 | 160000 | 银行、ATM 等 |
| 汽车 | 010000 | 加油站、停车场、4S店等 |

## 错误处理

| 错误码 | 含义 | 处理建议 |
|--------|------|----------|
| 10001 | key 不正确或过期 | 检查 API Key 配置 |
| 10003 | 访问已超出日访问量 | 等待次日或升级配额 |
| 20000 | 请求参数非法 | 检查参数格式 |
| 20001 | 缺少必填参数 | 补充必要参数 |
| 20800 | 规划点不在中国范围 | 确认坐标在国内 |
| 20801 | 路线规划失败 | 起终点可能不可达 |

## 最佳实践

1. **先定位再搜索**: 用户说"附近"时，先确定位置
2. **城市参数优先**: 搜索时尽量传入城市参数，提高准确性
3. **多策略对比**: 路线规划可使用 strategy=5 获取多条备选
4. **组合使用**: 地址 → 坐标 → 路线规划 是常见组合
5. **结果精简**: 返回结果时提取关键信息，避免信息过载